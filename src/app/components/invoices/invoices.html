<div class="container-fluid py-4">
  <div class="row mb-4">
    <div class="col-md-8">
      <h1 class="h2">Invoices</h1>
      <p class="text-muted">View all synced invoices from Xero</p>
    </div>
  </div>

  <div *ngIf="error" class="alert alert-danger alert-dismissible fade show" role="alert">
    {{ error }}
    <button type="button" class="btn-close" (click)="error = ''"></button>
  </div>

  <div class="row mb-4">
    <div class="col-md-4">
      <label class="form-label">Filter by Status</label>
      <select class="form-select" [(ngModel)]="selectedStatus" (change)="filterByStatus()">
        <option value="">All Statuses</option>
        <option *ngFor="let status of statusOptions" [value]="status">{{ status }}</option>
      </select>
    </div>
    <div class="col-md-8 d-flex align-items-end">
      <button class="btn btn-primary" (click)="loadInvoices()" [disabled]="loading">
        <i class="bi bi-arrow-clockwise"></i> Refresh
      </button>
    </div>
  </div>

  <div *ngIf="loading" class="text-center py-5">
    <div class="spinner-border" role="status">
      <span class="visually-hidden">Loading...</span>
    </div>
  </div>

  <div *ngIf="!loading && invoices.length > 0" class="card border-0 shadow-sm">
    <div class="table-responsive">
      <table class="table table-hover mb-0">
        <thead class="table-light">
          <tr>
            <th>Invoice #</th>
            <th>Contact</th>
            <th>Invoice Date</th>
            <th>Due Date</th>
            <th>Status</th>
            <th class="text-end">Total</th>
            <th class="text-end">Due</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let invoice of invoices">
            <td><strong>{{ invoice.invoiceNumber }}</strong></td>
            <td>{{ invoice.contactName }}</td>
            <td>{{ invoice.invoiceDate | date:'short' }}</td>
            <td>{{ invoice.dueDate | date:'short' }}</td>
            <td>
              <span class="badge" [ngClass]="getStatusBadgeClass(invoice.status)">
                {{ invoice.status }}
              </span>
            </td>
            <td class="text-end">{{ invoice.total | currency }}</td>
            <td class="text-end">{{ invoice.amountDue | currency }}</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <div *ngIf="!loading && invoices.length === 0" class="alert alert-info">
    <i class="bi bi-info-circle"></i> No invoices found. Try syncing data from Xero.
  </div>
</div>