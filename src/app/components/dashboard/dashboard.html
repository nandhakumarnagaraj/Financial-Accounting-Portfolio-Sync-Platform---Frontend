<div class="container-fluid py-4">
  <!-- Header -->
  <div class="row mb-4">
    <div class="col-md-8">
      <h1 class="h2">Dashboard</h1>
      <p class="text-muted" *ngIf="stats">Welcome, <strong>{{ stats.username }}</strong></p>
    </div>
    <div class="col-md-4 text-end">
      <button class="btn btn-outline-primary" (click)="refreshStats()" [disabled]="loading">
        <i class="bi bi-arrow-clockwise"></i> Refresh
      </button>
    </div>
  </div>

  <!-- Error Alert -->
  <div *ngIf="error" class="alert alert-danger alert-dismissible fade show" role="alert">
    {{ error }}
    <button type="button" class="btn-close" (click)="error = ''"></button>
  </div>

  <!-- Loading State -->
  <div *ngIf="loading" class="text-center py-5">
    <div class="spinner-border" role="status">
      <span class="visually-hidden">Loading...</span>
    </div>
  </div>

  <ng-container *ngIf="!loading && stats">
    <!-- Stats Cards -->
    <div class="row mb-4">
      <div class="col-md-4">
        <div class="card border-0 shadow-sm">
          <div class="card-body text-center">
            <h6 class="text-muted mb-2">Total Invoices</h6>
            <h2 class="text-primary">{{ stats.totalInvoices }}</h2>
            <small class="text-muted">Synced from Xero</small>
          </div>
        </div>
      </div>

      <div class="col-md-4">
        <div class="card border-0 shadow-sm">
          <div class="card-body text-center">
            <h6 class="text-muted mb-2">Xero Status</h6>
            <div *ngIf="stats.xeroConnected" class="badge bg-success p-2 mb-2">
              <i class="bi bi-check-circle"></i> Connected
            </div>
            <div *ngIf="!stats.xeroConnected" class="badge bg-danger p-2 mb-2">
              <i class="bi bi-exclamation-circle"></i> Not Connected
            </div>
            <small class="text-muted d-block">Click to manage connection</small>
          </div>
        </div>
      </div>

      <div class="col-md-4">
        <div class="card border-0 shadow-sm">
          <div class="card-body text-center">
            <h6 class="text-muted mb-2">Last Sync</h6>
            <p class="mb-0" *ngIf="syncStatus?.tokenExpiry">
              {{ syncStatus.tokenExpiry | date:'short' }}
            </p>
            <small class="text-muted" *ngIf="!syncStatus?.tokenExpiry">No sync yet</small>
          </div>
        </div>
      </div>
    </div>

    <!-- Quick Actions -->
    <div class="row mb-4">
      <div class="col-12">
        <div class="card border-0 shadow-sm">
          <div class="card-header bg-white border-bottom">
            <h6 class="mb-0">Quick Actions</h6>
          </div>
          <div class="card-body">
            <div class="btn-group" role="group">
              <a routerLink="/xero/sync" class="btn btn-primary">
                <i class="bi bi-arrow-repeat"></i> Sync Data
              </a>
              <a routerLink="/invoices" class="btn btn-outline-primary">
                <i class="bi bi-file-earmark-text"></i> View Invoices
              </a>
              <a routerLink="/accounts" class="btn btn-outline-primary">
                <i class="bi bi-bank"></i> View Accounts
              </a>
              <a routerLink="/xero" class="btn btn-outline-secondary">
                <i class="bi bi-gear"></i> Xero Settings
              </a>
            </div>
          </div>
        </div>
      </div>
    </div>
  </ng-container>
</div>